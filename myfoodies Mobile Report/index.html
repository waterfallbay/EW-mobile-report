<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="kendo/styles/kendo.mobile.all.min.css" rel="stylesheet" />

    <script src="cordova.js"></script>
    <script src="kendo/js/jquery.min.js"></script>
    <script src="kendo/js/kendo.mobile.min.js"></script>
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) --> 
    <!-- Include all compiled plugins (below), or include individual files as needed --> 
    <script src="js/bootstrap.min.js"></script> 
    <script src="js/jasny-bootstrap.min.js"></script> 
    <script src="js/jquery.dataTables.min.js"></script>
    <script src="js/jquery.cookie.js"></script>
    <script src="js/util.js"></script>
    <script src="js/main.js"></script>
    <script src="lang/lang.js"></script>
    
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/jasny-bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/media-query.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="login-page">
<section class="container">
	<a class="language" href="#" id="languagebar" onclick="setlang($.cookie('lang'))"></a>
    <h1 class="logo"><a href="#"><img src="images/logo2.png" alt="" class="img-responsive"></a><span id="mobilereport"></span></h1>
    <div class="row">
    	<div class="col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
        	<form action="http://everyware.cloudapp.net/Account/LogOnRest/" class="login" id="loginform">
            	<div class="form-group">
                	<input class="form-control" type="text" name="UserName" value="everyware005" placeholder="" id="loginusername">
                </div>
                <div class="form-group">
                	<input class="form-control" type="password" name="Password"  value="sanlung8888" placeholder="" id="loginpassword">
                </div>
                <div class="form-group form-check">
                	<input id="remembermecheck" type="checkbox" >
                    <label for="remembermecheck" id="rememberme" class="rememberme"></label>
                </div>
                <div class="clearfix"></div>
                <div class="form-group">
                	<input class="form-control" type="submit" value="" id="submit">
                </div>
                <div class="form-group">
                	<span class="error" id="errortext">&nbsp;</span>
                </div>
            </form>
        </div>
    </div>
    <span class="f-logo"><img src="images/everyware.png" alt="" class="img-responsive"></span>
</section>
<script>

$(document).ready(function(){

      $('#loginusername').attr("value" , getUserNameFromCookies());
      
      if($.cookie('rememberme') === "yes") {
          $('#remembermecheck').attr('checked', true);
      }
      else{
          $('#remembermecheck').attr('checked', false);
      }

    if ($.cookie('lang') === undefined){
        $.cookie('lang', 'zh', {expires:365, path:'/'});
        getLangText($.cookie('lang'));
    }else{
        getLangText($.cookie('lang'));
    }
});  
    
    
jQuery(document).submit(function(e){
	var msg = "login error: error message";
    var form = $(e.target);
    if(form.is("#loginform")){
        e.preventDefault();
        $.ajax({
            type: "GET",
			crossDomain: true,
            url: form.attr("action"), 
            data: form.serialize(), 
			dataType: 'jsonp',
			xhrFields: {
				withCredentials: true
			},
			
            success: function(data, status, xhr) {

				if (data.IsError == false){
					$("#errortext").html("&nbsp;");
		
                    //check remember me is checked, if yes write cookies for rememberme, username and password
                    if($('#remembermecheck').prop('checked')){
                        $.cookie('rememberme', "yes" , {expires:365, path:'/'});
                        $.cookie('username', $("#loginusername").val() , {expires:365, path:'/'});
                        
                    }
                    else{
                        forgeteverything();
                    }
                    
					//redirect window
					window.location.replace("dashboard.html");
				}
				else{
					$("#errortext").html(msg);
				}
            },
        });
    }
    
    //decide language
    if ($.cookie('lang') === undefined){
        $.cookie('lang', "zh" , {expires:365, path:'/'});
        getLangText($.cookie('lang'));
    }
    else{
        getLangText($.cookie('lang'));
    }
    
});
</script>
</body>
</html>
